<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCD Display Custom Character Designer</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        
        .main-grid {
            display: grid;
            grid-template-rows: repeat(4, 1fr);
            grid-template-columns: repeat(16, 1fr);
            gap: 4px;
            max-width: 100%;
            margin: 0 auto;
            background-color: #333;
            padding: 4px;
            border-radius: 8px;
            height: fit-content;
        }
        
        .square {
            background-color: #fff;
            border-radius: 4px;
            padding: 2px;
        }
        
        .sub-grid {
            display: grid;
            grid-template-rows: repeat(8, 1fr);
            grid-template-columns: repeat(5, 1fr);
            gap: 1px;
            width: 100%;
            height: 100%;
        }
        
        .small-square {
            background-color: #3b82f6; 
            border-radius: 2px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 16px;
        }
        
        .small-square:hover {
            opacity: 0.8;
        }
        
        .small-square.white {
            background-color: white;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .instructions {
            text-align: center;
            margin-bottom: 20px;
            color: #666;
        }
        
        .binary-display {
            margin-top: 30px;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .binary-grid {
            display: grid;
            grid-template-rows: repeat(4, 1fr);
            grid-template-columns: repeat(16, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .binary-square {
            padding: 8px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            line-height: 1.2;
            cursor: default;
        }
        
        .binary-square h4 {
            margin: 0 0 5px 0;
            font-size: 10px;
            color: #666;
            text-align: center;
        }
        
        .binary-row {
            margin: 1px 0;
            color: #333;
        }

        
        .binary-square.copied {
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.15);
            border-color: #10b981;
            background-color: #ecfdf5;
        }

        .binary-square .copy-hint {
            display: none;
            font-size: 9px;
            color: #10b981;
            text-align: center;
            margin-top: 6px;
        }

        .binary-square.copied .copy-hint {
            display: block;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Interactive Grid Toggle</h1>
        <div class="instructions">
            Click on any small square to toggle between blue and white
        </div>
    </div>
    
    <div class="controls" style="text-align:center; margin-bottom:16px;">
        <label for="rowsSelect">Rows:</label>
        <select id="rowsSelect" aria-label="Number of rows for main grid"></select>
        <label for="colsSelect" style="margin-left:12px;">Columns:</label>
        <select id="colsSelect" aria-label="Number of columns for main grid"></select>
        <button id="applySize" style="margin-left:12px;">Apply</button>
    </div>
    
    <div class="main-grid" id="mainGrid">
        
    </div>
    
    <div class="binary-display" id="binaryDisplay">
        <h2>Binary Arrays for Each Big Square</h2>
        <div class="binary-grid" id="binaryGrid">
            
        </div>
    </div>

    <script>
        
        let mainRows = 4;
        let mainCols = 16;
        const subRows = 8;
        const subCols = 5;

        
        function createGrid() {
            const mainGrid = document.getElementById('mainGrid');
            mainGrid.innerHTML = '';
            
            mainGrid.style.gridTemplateRows = `repeat(${mainRows}, 1fr)`;
            mainGrid.style.gridTemplateColumns = `repeat(${mainCols}, 1fr)`;

            for (let row = 0; row < mainRows; row++) {
                for (let col = 0; col < mainCols; col++) {
                    
                    const square = document.createElement('div');
                    square.className = 'square';

                    
                    const subGrid = document.createElement('div');
                    subGrid.className = 'sub-grid';

                    for (let subRow = 0; subRow < subRows; subRow++) {
                        for (let subCol = 0; subCol < subCols; subCol++) {
                            const smallSquare = document.createElement('div');
                            smallSquare.className = 'small-square';

                            
                            smallSquare.addEventListener('click', function() {
                                toggleSquareColor(this);
                            });

                            
                            smallSquare.dataset.mainRow = row;
                            smallSquare.dataset.mainCol = col;
                            smallSquare.dataset.subRow = subRow;
                            smallSquare.dataset.subCol = subCol;

                            subGrid.appendChild(smallSquare);
                        }
                    }

                    square.appendChild(subGrid);
                    mainGrid.appendChild(square);
                }
            }
        }
        
        
        function toggleSquareColor(square) {
            square.classList.toggle('white');
            updateBinaryDisplay();
        }
        
        
        function generateBinaryArray(mainRow, mainCol) {
            const binaryArray = [];

            for (let subRow = 0; subRow < subRows; subRow++) {
                let binaryString = 'B';

                for (let subCol = 0; subCol < subCols; subCol++) {
                    const square = document.querySelector(
                        `[data-main-row="${mainRow}"][data-main-col="${mainCol}"][data-sub-row="${subRow}"][data-sub-col="${subCol}"]`
                    );

                    binaryString += square && square.classList.contains('white') ? '1' : '0';
                }

                binaryString += subRow != subRows - 1 ? ',' : '';
                binaryArray.push(binaryString);
            }

            return binaryArray;
        }
        
        function createBinaryDisplay() {
            const binaryGrid = document.getElementById('binaryGrid');
            binaryGrid.innerHTML = '';
            
            binaryGrid.style.gridTemplateRows = `repeat(${mainRows}, 1fr)`;
            binaryGrid.style.gridTemplateColumns = `repeat(${mainCols}, 1fr)`;

            for (let row = 0; row < mainRows; row++) {
                for (let col = 0; col < mainCols; col++) {
                    const binarySquare = document.createElement('div');
                    binarySquare.className = 'binary-square';
                    binarySquare.id = `binary-${row}-${col}`;

                    binarySquare.style.cursor = 'pointer';
                    binarySquare.setAttribute('role', 'button');
                    binarySquare.setAttribute('tabindex', '0');

                    const title = document.createElement('h4');
                    title.textContent = `[${row},${col}]`;
                    binarySquare.appendChild(title);

                    for (let i = 0; i < subRows; i++) {
                        const binaryRow = document.createElement('div');
                        binaryRow.className = 'binary-row';
                        binaryRow.textContent = '0'.repeat(subCols);
                        binarySquare.appendChild(binaryRow);
                    }

                    const hint = document.createElement('div');
                    hint.className = 'copy-hint';
                    hint.textContent = 'Copied to clipboard';
                    binarySquare.appendChild(hint);

                    binarySquare.addEventListener('click', async function(e) {
                        e.stopPropagation();
                        const arr = generateBinaryArray(row, col).map(s => s.replace(/,$/, ''));
                        
                        const formatted = '[' + arr.map(s => `'${s}'`).join(', ') + ']';
                        await copyTextToClipboard(formatted, binarySquare);
                    });

                    binarySquare.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            this.click();
                        }
                    });

                    binaryGrid.appendChild(binarySquare);
                }
            }
        }

        
        async function copyTextToClipboard(text, binarySquare) {
            try {
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(text);
                } else {
                    
                    const ta = document.createElement('textarea');
                    ta.value = text;
                    
                    ta.setAttribute('readonly', '');
                    ta.style.position = 'absolute';
                    ta.style.left = '-9999px';
                    document.body.appendChild(ta);
                    ta.select();
                    document.execCommand('copy');
                    document.body.removeChild(ta);
                }

                binarySquare.classList.add('copied');
                setTimeout(() => binarySquare.classList.remove('copied'), 1200);
            } catch (err) {
                console.error('Copy failed', err);
            }
        }
        
        function updateBinaryDisplay() {
            for (let row = 0; row < 4; row++) {
                for (let col = 0; col < 16; col++) {
                    const binaryArray = generateBinaryArray(row, col);
                    const binarySquare = document.getElementById(`binary-${row}-${col}`);
                    const binaryRows = binarySquare.querySelectorAll('.binary-row');
                    
                    binaryArray.forEach((binaryString, index) => {
                        if (binaryRows[index]) {
                            binaryRows[index].textContent = binaryString;
                        }
                    });
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            populateSizeControls();
            createGrid();
            createBinaryDisplay();
            updateBinaryDisplay();
            document.getElementById('applySize').addEventListener('click', function() {
                const r = parseInt(document.getElementById('rowsSelect').value, 10);
                const c = parseInt(document.getElementById('colsSelect').value, 10);
                if (!isNaN(r) && !isNaN(c) && r > 0 && c > 0) {
                    mainRows = r;
                    mainCols = c;
                    createGrid();
                    createBinaryDisplay();
                    updateBinaryDisplay();
                }
            });
        });

        function populateSizeControls() {
            const rowsSelect = document.getElementById('rowsSelect');
            const colsSelect = document.getElementById('colsSelect');
            rowsSelect.innerHTML = '';
            colsSelect.innerHTML = '';

            for (let r = 1; r <= 8; r++) {
                const opt = document.createElement('option');
                opt.value = r;
                opt.textContent = r;
                if (r === mainRows) opt.selected = true;
                rowsSelect.appendChild(opt);
            }

            for (let c = 1; c <= 40; c++) {
                const opt = document.createElement('option');
                opt.value = c;
                opt.textContent = c;
                if (c === mainCols) opt.selected = true;
                colsSelect.appendChild(opt);
            }
        }
        
        function resetAllSquares() {
            const allSquares = document.querySelectorAll('.small-square');
            allSquares.forEach(square => {
                square.classList.remove('white');
            });
            updateBinaryDisplay();
        }
        
        function getCurrentState() {
            const allSquares = document.querySelectorAll('.small-square');
            const state = [];
            
            allSquares.forEach(square => {
                state.push({
                    mainRow: parseInt(square.dataset.mainRow),
                    mainCol: parseInt(square.dataset.mainCol),
                    subRow: parseInt(square.dataset.subRow),
                    subCol: parseInt(square.dataset.subCol),
                    isWhite: square.classList.contains('white')
                });
            });
            
            return state;
        }
        
        document.addEventListener('keydown', function(e) {
            if (e.key === 'r' || e.key === 'R') {
                resetAllSquares();
            }
        });
    </script>
</body>
</html>