<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Toggle - 16x4 with Sub-grids</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        
        .main-grid {
            display: grid;
            grid-template-rows: repeat(4, 1fr);
            grid-template-columns: repeat(16, 1fr);
            gap: 4px;
            max-width: 100%;
            margin: 0 auto;
            background-color: #333;
            padding: 4px;
            border-radius: 8px;
            height: fit-content;
        }
        
        .square {
            background-color: #fff;
            border-radius: 4px;
            padding: 2px;
        }
        
        .sub-grid {
            display: grid;
            grid-template-rows: repeat(8, 1fr);
            grid-template-columns: repeat(5, 1fr);
            gap: 1px;
            width: 100%;
            height: 100%;
        }
        
        .small-square {
            background-color: #3b82f6; /* Default blue color */
            border-radius: 2px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 16px;
        }
        
        .small-square:hover {
            opacity: 0.8;
        }
        
        .small-square.white {
            background-color: white;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .instructions {
            text-align: center;
            margin-bottom: 20px;
            color: #666;
        }
        
        .binary-display {
            margin-top: 30px;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .binary-grid {
            display: grid;
            grid-template-rows: repeat(4, 1fr);
            grid-template-columns: repeat(16, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .binary-square {
            padding: 8px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            line-height: 1.2;
            cursor: default;
        }
        
        .binary-square h4 {
            margin: 0 0 5px 0;
            font-size: 10px;
            color: #666;
            text-align: center;
        }
        
        .binary-row {
            margin: 1px 0;
            color: #333;
        }

        /* Visual feedback when a binary-square is copied */
        .binary-square.copied {
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.15);
            border-color: #10b981;
            background-color: #ecfdf5;
        }

        .binary-square .copy-hint {
            display: none;
            font-size: 9px;
            color: #10b981;
            text-align: center;
            margin-top: 6px;
        }

        .binary-square.copied .copy-hint {
            display: block;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Interactive Grid Toggle</h1>
        <div class="instructions">
            Click on any small square to toggle between blue and white
        </div>
    </div>
    
    <div class="main-grid" id="mainGrid">
        <!-- Grid will be generated by JavaScript -->
    </div>
    
    <div class="binary-display" id="binaryDisplay">
        <h2>Binary Arrays for Each Big Square</h2>
        <div class="binary-grid" id="binaryGrid">
            <!-- Binary arrays will be displayed here -->
        </div>
    </div>

    <script>
        // Generate the main grid structure
        function createGrid() {
            const mainGrid = document.getElementById('mainGrid');
            
            // Create 16 rows × 4 columns = 64 main squares
            for (let row = 0; row < 4; row++) {
                for (let col = 0; col < 16; col++) {
                    // Create main square container
                    const square = document.createElement('div');
                    square.className = 'square';
                    
                    // Create sub-grid (8 columns × 4 rows = 32 small squares)
                    const subGrid = document.createElement('div');
                    subGrid.className = 'sub-grid';
                    
                    // Create 8 rows × 5 columns = 40 small squares for each main square
                    for (let subRow = 0; subRow < 8; subRow++) {
                        for (let subCol = 0; subCol < 5; subCol++) {
                            const smallSquare = document.createElement('div');
                            smallSquare.className = 'small-square';
                            
                            // Add click event listener for toggle functionality
                            smallSquare.addEventListener('click', function() {
                                toggleSquareColor(this);
                            });
                            
                            // Add data attributes for identification
                            smallSquare.dataset.mainRow = row;
                            smallSquare.dataset.mainCol = col;
                            smallSquare.dataset.subRow = subRow;
                            smallSquare.dataset.subCol = subCol;
                            
                            subGrid.appendChild(smallSquare);
                        }
                    }
                    
                    square.appendChild(subGrid);
                    mainGrid.appendChild(square);
                }
            }
        }
        
        // Toggle square color between blue and white
        function toggleSquareColor(square) {
            square.classList.toggle('white');
            updateBinaryDisplay();
        }
        
        // Generate binary array for a specific big square
        function generateBinaryArray(mainRow, mainCol) {
            const binaryArray = [];
            
            // For each of the 8 rows in the sub-grid
            for (let subRow = 0; subRow < 8; subRow++) {
                let binaryString = 'B';
                
                // For each of the 5 columns in the sub-grid
                for (let subCol = 0; subCol < 5; subCol++) {
                    const square = document.querySelector(
                        `[data-main-row="${mainRow}"][data-main-col="${mainCol}"][data-sub-row="${subRow}"][data-sub-col="${subCol}"]`
                    );
                    
                    // 0 for blue (default), 1 for white (clicked)
                    binaryString += square && square.classList.contains('white') ? '1' : '0';
                }

                binaryString += subRow != 7 ? ',' : '';
                
                binaryArray.push(binaryString);
            }
            
            return binaryArray;
        }
        
        // Create binary display grid (interactive: click to copy the slot's binary array)
        function createBinaryDisplay() {
            const binaryGrid = document.getElementById('binaryGrid');
            binaryGrid.innerHTML = '';

            // Create display for each big square (4 rows × 16 columns)
            for (let row = 0; row < 4; row++) {
                for (let col = 0; col < 16; col++) {
                    const binarySquare = document.createElement('div');
                    binarySquare.className = 'binary-square';
                    binarySquare.id = `binary-${row}-${col}`;

                    // Make the binary square interactive (click to copy)
                    binarySquare.style.cursor = 'pointer';
                    binarySquare.setAttribute('role', 'button');
                    binarySquare.setAttribute('tabindex', '0');

                    const title = document.createElement('h4');
                    title.textContent = `[${row},${col}]`;
                    binarySquare.appendChild(title);

                    // Add 8 rows for binary data
                    for (let i = 0; i < 8; i++) {
                        const binaryRow = document.createElement('div');
                        binaryRow.className = 'binary-row';
                        binaryRow.textContent = '00000'; // Initial state
                        binarySquare.appendChild(binaryRow);
                    }

                    // Small hint element shown briefly after copying
                    const hint = document.createElement('div');
                    hint.className = 'copy-hint';
                    hint.textContent = 'Copied to clipboard';
                    binarySquare.appendChild(hint);

                    // Click handler: copy the binary array for this slot
                    binarySquare.addEventListener('click', async function(e) {
                        e.stopPropagation();
                        const arr = generateBinaryArray(row, col).map(s => s.replace(/,$/, ''));
                        // Format as a JS array literal with strings
                        const formatted = '{' + arr.map(s => `'${s}'`).join(', ') + '}';
                        await copyTextToClipboard(formatted, binarySquare);
                    });

                    // Also allow Enter/Space to trigger copy for keyboard users
                    binarySquare.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            this.click();
                        }
                    });

                    binaryGrid.appendChild(binarySquare);
                }
            }
        }

        // Clipboard helper with fallback and visual feedback
        async function copyTextToClipboard(text, binarySquare) {
            try {
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(text);
                } else {
                    // Fallback for older browsers
                    const ta = document.createElement('textarea');
                    ta.value = text;
                    // Make textarea out of flow and readonly to avoid mobile keyboard
                    ta.setAttribute('readonly', '');
                    ta.style.position = 'absolute';
                    ta.style.left = '-9999px';
                    document.body.appendChild(ta);
                    ta.select();
                    document.execCommand('copy');
                    document.body.removeChild(ta);
                }

                // Show visual feedback
                binarySquare.classList.add('copied');
                setTimeout(() => binarySquare.classList.remove('copied'), 1200);
            } catch (err) {
                console.error('Copy failed', err);
            }
        }
        
        // Update binary display in real time
        function updateBinaryDisplay() {
            for (let row = 0; row < 4; row++) {
                for (let col = 0; col < 16; col++) {
                    const binaryArray = generateBinaryArray(row, col);
                    const binarySquare = document.getElementById(`binary-${row}-${col}`);
                    const binaryRows = binarySquare.querySelectorAll('.binary-row');
                    
                    binaryArray.forEach((binaryString, index) => {
                        if (binaryRows[index]) {
                            binaryRows[index].textContent = binaryString;
                        }
                    });
                }
            }
        }
        
        // Initialize the grid when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createGrid();
            createBinaryDisplay();
            updateBinaryDisplay();
        });
        
        // Optional: Add functionality to reset all squares to blue
        function resetAllSquares() {
            const allSquares = document.querySelectorAll('.small-square');
            allSquares.forEach(square => {
                square.classList.remove('white');
            });
            updateBinaryDisplay();
        }
        
        // Optional: Add functionality to get current state
        function getCurrentState() {
            const allSquares = document.querySelectorAll('.small-square');
            const state = [];
            
            allSquares.forEach(square => {
                state.push({
                    mainRow: parseInt(square.dataset.mainRow),
                    mainCol: parseInt(square.dataset.mainCol),
                    subRow: parseInt(square.dataset.subRow),
                    subCol: parseInt(square.dataset.subCol),
                    isWhite: square.classList.contains('white')
                });
            });
            
            return state;
        }
        
        // Add keyboard shortcuts (optional)
        document.addEventListener('keydown', function(e) {
            if (e.key === 'r' || e.key === 'R') {
                resetAllSquares();
            }
        });
    </script>
</body>
</html>